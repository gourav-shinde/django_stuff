<!DOCTYPE html>
<html>

<head> 
	<title>ARSENEL-Student</title>
	{% load static %}
	
  <!-- new navbar -->
  <!-- <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script> -->
 	<meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="all,follow">
    <!-- Bootstrap CSS-->
    <link rel="stylesheet" href="{% static 'bubbly/vendor/bootstrap/css/bootstrap.min.css' %}">
    <!-- Font Awesome CSS-->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
    <!-- Google fonts - Popppins for copy-->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:300,400,800">
    <!-- orion icons-->
    <link rel="stylesheet" href="{% static 'bubbly/css/orionicons.css' %}">
    <!-- theme stylesheet-->
    <link rel="stylesheet" href="{% static 'bubbly/css/style.default.css' %}" id="theme-stylesheet">
    <!-- Custom stylesheet - for your changes-->
    <link rel="stylesheet" href="{% static 'bubbly/css/custom.css' %}">
	<!-- Favicon-->
	<link rel="apple-touch-icon" sizes="57x57" href="{% static 'Logos/apple-icon-57x57.png' %}">
	<link rel="apple-touch-icon" sizes="60x60" href="{% static 'Logos/apple-icon-60x60.png' %}">
	<link rel="apple-touch-icon" sizes="72x72" href="{% static 'Logos/apple-icon-72x72.png' %}">
	<link rel="apple-touch-icon" sizes="76x76" href="{% static 'Logos/apple-icon-76x76.png' %}">
	<link rel="apple-touch-icon" sizes="114x114" href="{% static 'Logos/apple-icon-114x114.png' %}">
	<link rel="apple-touch-icon" sizes="120x120" href="{% static 'Logos/apple-icon-120x120.png' %}">
	<link rel="apple-touch-icon" sizes="144x144" href="{% static 'Logos/apple-icon-144x144.png' %}">
	<link rel="apple-touch-icon" sizes="152x152" href="{% static 'Logos/apple-icon-152x152.png' %}">
	<link rel="apple-touch-icon" sizes="180x180" href="{% static 'Logos/apple-icon-180x180.png' %}">
	<link rel="icon" type="image/png" sizes="192x192"  href="{% static 'Logos/android-icon-192x192.png' %}">
	<!-- <link rel="icon" type="image/png" sizes="32x32" href="{% static 'Logos/favicon-32x32.png' %}"> -->
	<link rel="icon" type="image/png" sizes="96x96" href="{% static 'Logos/favicon-96x96.png' %}">
	<link rel="icon" type="image/png" sizes="16x16" href="{% static 'Logos/favicon.ico' %}">
	<link rel="manifest" href="{% static 'Logos//manifest.json' %}">
	<meta name="msapplication-TileColor" content="#ffffff">
	<meta name="msapplication-TileImage" content="{% static 'Logos/ms-icon-144x144.png' %}">
	<meta name="theme-color" content="#ffffff">
    
    

    
	

</head>    
<body>
  <input type="text" name="handle" id="handle_id" style="display: none;">


{% include 'navbar.html' %}

<style>
  @media only screen and (max-width: 700px) {
		  /* For mobile phones: */
		  .side25{
		    position: fixed;
		    height: 100vh;
		    z-index: 2;
		  } 
		  
		}
    .disappeared{
        display: none;
    }
    .class_card{
      height: 200px;
      padding-top: 20px;
      padding-left: 5px;
      padding-right: 5px;  
      margin-bottom: 5px;   
    }
    .contain{
      padding-left: 10px;
      padding-right: 10px;
    }

    .class_card:hover{
      box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
    }
</style>



<div class="d-flex align-items-stretch">

    <!-- sidebar -->
    <div id="sidebar" class="sidebar py-3 side25">
      <div class="text-uppercase px-3 px-lg-4 py-4 font-weight-bold small headings-font-family" style="color: #4287f5">MAIN</div>
      <ul class="sidebar-menu list-unstyled">
            <li class="sidebar-list-item"><a  id="home" class="sidebar-link text-muted"><i class="o-home-1 mr-3 text-gray"></i><span style="cursor: pointer;">Home</span></a></li>
            <li class="sidebar-list-item"><a  id="posts" class="sidebar-link text-muted"><i class="o-table-content-1 mr-3 text-gray"></i><span style="cursor: pointer;">Posts</span></a></li>
            <li class="sidebar-list-item"><a  id="quiz" class="sidebar-link text-muted"><i class="o-survey-1 mr-3 text-gray"></i><span style="cursor: pointer;">Quiz</span></a></li>
        <!-- links href="{% url 'bloggy:posts' %}" href="{% url 'quizzes:quiz_stud' %}" href="{% url 'app1:studprof' %}" -->

      </ul>
      <div class=" text-uppercase px-3 px-lg-4 py-4 font-weight-bold small headings-font-family" style="color: #4287f5">EXTRAS</div>
      <ul class="sidebar-menu list-unstyled">
            <li class="sidebar-list-item"><a href="{% url 'custom_user:logout' %}" class="sidebar-link text-muted"><i class="o-exit-1 mr-3 text-gray"></i><span>Logout</span></a></li>
      </ul>
    </div>
    <!-- sidebarend -->
    
    <div class="page-holder w-100 d-flex flex-wrap">
      <div class="container-fluid px-xl-5">

        <section id="insert/delete">

        </section>
       
        <section class="py-5 disappeared" id="profile_section">
          <div class="row mb-4">
            <div class="col-lg-7 mb-4 mb-lg-0">
              <div class="card w-100 h-100" >
                <div class="card-header">
                  <h2 class="h6 text-uppercase mb-0">Profile</h2>
                </div>
                <div class="card-body" id="profile">
                  
                </div>
              </div>
            </div>
            <div class="col-lg-5 mb-4 mb-lg-0 pl-lg-0" id="addTwo">
              <!-- <div class="card mb-3" style="max-height: 175px;">
                <div class="card-body">
                  <div class="row align-items-center flex-row">
                    <div class="col-lg-5">
                      <h2 class="mb-0 d-flex align-items-center"><span>100</span><span class="dot bg-green d-inline-block ml-3"></span></h2><span class="text-muted text-uppercase small">Work hours</span>
                      <hr><small class="text-muted">Lorem ipsum dolor sit</small>
                    </div>
                    <div class="col-lg-7">
                      <canvas id="pieChartHome01"></canvas>
                    </div>
                  </div>
                </div>
              </div>
              
              <div class="card" style="max-height: 175px;">
                <div class="card-body">
                  <div class="row align-items-center flex-row">
                    <div class="col-lg-5">
                      <h2 class="mb-0 d-flex align-items-center"><span>1.724</span><span class="dot bg-violet d-inline-block ml-3"></span></h2><span class="text-muted text-uppercase small">Server time</span>
                      <hr><small class="text-muted">Lorem ipsum dolor sit</small>
                    </div>
                    <div class="col-lg-7">
                      <canvas id="pieChartHome02"></canvas>
                    </div>
                  </div>
                </div>
              </div> -->
            </div>
          </div>
          <div class="row">
            <div class="col-lg-5 mb-4 mb-lg-0">
              <div class="card mb-3">
                <div class="card-body">
                  <div class="row align-items-center mb-3 flex-row">
                    <div class="col-lg-5">
                      <h2 class="mb-0 d-flex align-items-center"><span>86%</span><span class="dot bg-violet d-inline-block ml-3"></span></h2><span class="text-muted text-uppercase small">Monthly Usage</span>
                      <hr><small class="text-muted">Lorem ipsum dolor sit</small>
                    </div>
                    <div class="col-lg-7">
                      <canvas id="pieChartHome3"></canvas>
                    </div>
                  </div>
                </div>
              </div>
              <div class="card">
                <div class="card-body">
                  <div class="row align-items-center flex-row">
                    <div class="col-lg-5">
                      <h2 class="mb-0 d-flex align-items-center"><span>$126,41</span><span class="dot bg-green d-inline-block ml-3"></span></h2><span class="text-muted text-uppercase small">All Income</span>
                      <hr><small class="text-muted">Lorem ipsum dolor sit</small>
                    </div>
                    <div class="col-lg-7">
                      <canvas id="pieChartHome4"></canvas>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-lg-7">
              <div class="card w-100 h-100">
                <div class="card-header">
                  <h2 class="h6 text-uppercase mb-0">Total Overdue</h2>
                </div>
                <div class="card-body">
                  <p class="text-gray">Lorem ipsum dolor sit amet, consectetur adipisicing elit.</p>
                  <div class="chart-holder">
                    <canvas id="lineChart2" style="max-height: 14rem !important;" class="w-100"></canvas>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
        </section>
        
      </div>
      <footer class="footer bg-white shadow align-self-end py-3 px-xl-5 w-100">
        <div class="container-fluid">
          <div class="row">
            <div class="col-md-6 text-center text-md-left text-primary">
              <p class="mb-2 mb-md-0">Gaurav Shinde(js)</p>
            </div>

          </div>
        </div>
      </footer>
    </div>
  </div>
    
    <script>


        function redirect(slug){
            console.log(slug)
            window.location.replace("http://127.0.0.1:8000/quiz/trans/"+slug);

        }

        function secPosts(id){
          document.getElementById("insert/delete").innerHTML="";

          function cb(data){
            console.log(data);
            var p = document.getElementById("insert/delete");


            p.innerHTML=
            `
            <div class="row">
              <div class="col-12">
                <div class="jumbotron" style="border-radius:15px;padding-top:30px;height:150px;">
                  <h2>Title</h2>
                  <p>http://127.0.0.1:8000/posts/myPostApi/`+id+`</p>
                </div>
              </div>
            </div>

            <div class="row mb-2">
            <div class="col-12">
              <div id="inputy"class="card" style="min-height:100px">
                <div class="container" id="clicko" style="padding-top:30px;height:100%;width:100%;">
                  <h5 class="ml-4">Share something with your class</h5>
                </div>

              <div class="container disappeared" id="formm" style="padding-top:30px;padding-bottom:20px;">
                <form action="www.google.com" method="POST" id="create-post" class="form">{% csrf_token %}
                  <input type="text" class="disappeared" name="section" value="`+id+`">
                  <input name="title" style="margin:5px;"class="form-control"type="text" placeholder="Title" required>
                  <textarea class="form-control" style="margin:5px;" name="description" rows="4" cols="50" placeholder="Description" required></textarea>
                  <hr>
                  <a id="close" class="btn btn-primary">Close</a>
                  <button type="submit" class="btn btn-success" value="Submit">Post</button>
                  
                </form>
              </div>

              </div>
            </div>
            </div>

            <div id="posts22">
            </div>
            
            `
            var posty=document.getElementById("posts22")
            for(var i=0;i<data.posts.length;i++)
            {
              posty.innerHTML=posty.innerHTML+
              `
              <div class="row mt-3">
                <div class="col-12">
                  <div class="card" style="min-height:100px">
                  <div class="container" style="padding-top:10px;padding-left:10px;">
                    <div class="row mb-1" >
                     <div class="col-10 mt-2 ml-5">
                     <b>`+data.use[i]+`</b><br><small>`+data.posts[i].date_posted+`<small>
                     </div>
                    </div>
                    <div class="row mb-1" >
                     <div class="col-12">
                      <div class="container jumbotron"  style="width:100%;padding:20px;">
                        <div class="">
                          <h3>`+data.posts[i].title+`</h3><br>
                          <p  style="font-size: 15px;">`+data.posts[i].description+`</p>
                        </div>
                      </div>
                     
                     </div>
                    </div>
                  </div>
                  </div>
                </div>
              </div>

              `
            }
                  // input tag of posts
            document.getElementById("close").addEventListener("click", toggley);
            document.getElementById("clicko").addEventListener("click", myinput);
            function myinput(){
              document.getElementById("clicko").className="container disappeared";
              document.getElementById("formm").className="container";

              function form_submit(event){
              //console.log("hello")
              event.preventDefault()
              const myForm =event.target
              const myFromData= new FormData(myForm)
              const url="http://127.0.0.1:8000/posts/myClass/create"
              const method=myForm.getAttribute("method")
              //console.log(event)
              const xhr=new XMLHttpRequest()
              xhr.open(method,url)
              xhr.onload=function(){
                const serverResponse =xhr.response
                //console.log(serverResponse)
                secPosts(id);
              }
              xhr.send(myFromData)

              }

              const form_create=document.getElementById("create-post");
              form_create.addEventListener("submit",form_submit);
              
            }
            function toggley(){
              document.getElementById("clicko").className="container";
              document.getElementById("formm").className="container disappeared";
              
            }

            


            
            }

            $.get("http://127.0.0.1:8000/posts/myPostApi/"+id,cb);

        }

        function replot(id_str,per){
          console.log(id_str);
          console.log(per);
          console.log(100-per);
          var PIECHART = $(id_str);
          var myPieChart = new Chart(PIECHART, {
              type: 'doughnut',
              options: {
                  cutoutPercentage: 90,
                  legend: {
                      display: false
                  }
              },
              data: {
                  labels: [
                      "First",
                      "Second",
                      "Third"
                  ],
                  datasets: [{
                      data: [per, 100-per],
                      borderWidth: [0, 0],
                      
                  }]
              }
          });

        }
        

        document.getElementById("home").addEventListener("click", myhome);
        document.getElementById("posts").addEventListener("click", mypost);
        document.getElementById("quiz").addEventListener("click", myquiz);


        function myhome() {
            document.getElementById("sidebar").className="sidebar py-3 side25";
            document.getElementById("home").className = "sidebar-link text-muted active";
            document.getElementById("posts").className = "sidebar-link text-muted";
            document.getElementById("quiz").className = "sidebar-link text-muted";
            document.getElementById("profile_section").className="py-5";
            document.getElementById("insert/delete").className="";
            document.getElementById("insert/delete").innerHTML="";
            document.getElementById("handle_id").value = "home"; 

            function cb(data){
           //console.log(data);
          
          const profile_body=document.getElementById("profile");
          const profile_card=document.getElementById("profile_section");
          const twoup=document.getElementById("addTwo");
          document.getElementById("handle_id").value = "home"; 

          
          if(data.classes=="None")
          {
          //console.log("hello")
          profile.innerHTML=`
          <h5>Name :<span style = "text-transform:uppercase;"> {{request.user.username}}</span></h5>
          <h6>Email : {{request.user.email}}</h5>
          <h6>Classes: None</h6>
          Please ask your teacher to add in the class
          
          `;
          }
          else
          {
          //console.log("True")
          var str=""
          for(var i=0;i<data.sections.length;i++)
          {
              str=str+"<li>"+data.sections[i].year+" "+data.sections[i].div+"</li>"
          }
          profile.innerHTML=`
          <h5>Name :<span style = "text-transform:uppercase;"> {{request.user.username}}</span></h5>
          <h6>Email : {{request.user.email}}</h5>
          <h6>Classes:</h6>
          <ul>`+str+`</ul>
          `;
          var lect;
          var str_lect="";
          for(var i=0;i<data.lectures.length && i<2;i++)
          {
              lect=data.lectures[i];
              str_lect=str_lect+
              `
              <div class="card mb-3" style="max-height: 175px;">
                <div class="card-body">
                  <div class="row align-items-center flex-row">
                    <div class="col-lg-5">
                      <h2 class="mb-0 d-flex align-items-center"><span>`+lect.percentage+`</span><span class="dot bg-green d-inline-block ml-3"></span></h2><span class="text-muted text-uppercase small">`+lect.name+`</span>
                      <hr><small class="text-muted">`+lect.section+`</small>
                    </div>
                    <div class="col-lg-7">
                      <canvas id="pieChartHome`+i+1+`"></canvas>
                    </div>
                  </div>
                </div>
              </div>

              `;

              

          }
          document.getElementById("addTwo").innerHTML=str_lect;

          for(var i=0;i<data.lectures.length && i<2;i++)
          {
              lect=data.lectures[i];
              var str="pieChartHome"+i+1;
              replot(str,lect.percentage);
          }
          }
          




          



        

          
        }

        $.get("http://127.0.0.1:8000/app1/Studentprofile",cb);
            
        }

        function mypost() {
            document.getElementById("sidebar").className="sidebar py-3 side25";
            document.getElementById("home").className = "sidebar-link text-muted";
            document.getElementById("posts").className = "sidebar-link text-muted active";
            document.getElementById("quiz").className = "sidebar-link text-muted";
            document.getElementById("profile_section").className="py-5 disappeared";
            document.getElementById("insert/delete").className="py-5";
            document.getElementById("insert/delete").innerHTML="";
            document.getElementById("handle_id").value = "post"; 
            // console.log("posts")

            function cb(data){
            console.log(data);
            var p = document.getElementById("insert/delete");

            str=""
            if(data.flag=="True")
            {
              for(var i=0;i<data.sections.length;i++)
              {
                var sec=data.sections[i];
                str=str+
                `
                <div class="col-lg-3 col-12 contain">
                <div id="`+sec.id+`" class="card class_card" onclick="secPosts(this.id)">
                  <div class="container contain ">
                    <h4><b>`+sec.year+` `+sec.div+`</b></h4>
                    <p>Beta</p>
                  </div>
                </div> 
                </div>
                `

              }


            }
            else
            {
              str=
              `
              `

            }


            p.innerHTML=
            `
            <div class="row">
            `+str+`
            

            </div>
            `


            
            }

            $.get("http://127.0.0.1:8000/posts/myClass",cb);
        }

        function myquiz() {
            document.getElementById("sidebar").className="sidebar py-3 side25";
            document.getElementById("home").className = "sidebar-link text-muted";
            document.getElementById("posts").className = "sidebar-link text-muted";
            document.getElementById("quiz").className = "sidebar-link text-muted active";
            document.getElementById("profile_section").className="py-5 disappeared";
            document.getElementById("insert/delete").className="py-5";
            document.getElementById("handle_id").value = "quiz"; 

            function cb(data){
            // console.log(data);
            var p = document.getElementById("insert/delete");
            var str_ongoing=""
            var quiz;
            console.log(data.ongoing.length)
            for(var i=0;i<data.ongoing.length;i++)
            {
                quiz=data.ongoing[i]
                str_ongoing=str_ongoing+
                `
                <div class="d-flex justify-content-between align-items-start align-items-sm-center mb-4 flex-column flex-sm-row" style="position: relative;">
                        <div class="left d-flex align-items-center">
                            <!-- <div class="icon icon-lg shadow mr-3 text-gray"><i class="fab fa-dropbox"></i></div> -->
                            <div class="text">
                            <h6 class="mb-0 d-flex align-items-center"><span>`+quiz.name+`</span><span class="dot dot-sm ml-2 bg-blue"></span></h6><small class="text-gray">`+quiz.lecture+`<br>`+quiz.time+` to `+quiz.stop+`</small>
                            </div>
                        </div>
                        <div class="right ml-5 ml-sm-0 pl-3 pl-sm-0 text-violet" style="position: absolute; right: 0px;">
                            <table style="border:0px;">
                                        <tr><td><a style="cursor: pointer;" onclick='redirect("`+quiz.slug+`")'>Attempt</a></td></tr>
                                        
                            </table>
                        </div>
                </div>
                `
            }
            var expired =""
            for(var i=0;i<data.expired.length;i++)
            {
                quiz=data.expired[i]
                expired=expired+
                `
                <div class="d-flex justify-content-between align-items-start align-items-sm-center mb-4 flex-column flex-sm-row" style="position: relative;">
                        <div class="left d-flex align-items-center">
                            <!-- <div class="icon icon-lg shadow mr-3 text-gray"><i class="fab fa-dropbox"></i></div> -->
                            <div class="text">
                            <h6 class="mb-0 d-flex align-items-center"> <span>`+quiz.name+`</span><span class="dot dot-sm ml-2 bg-blue"></span></h6><small class="text-gray">`+quiz.lecture+`</small>
                            </div>
                        </div>
                        <div class="right ml-5 ml-sm-0 pl-3 pl-sm-0 text-violet" style="position: absolute; right: 0px;">
                            <table style="border:0px;">
                                <tr><td>`+quiz.score+`</td></tr>
                            </table>
                        </div>
                </div>
                `
            }

            p.innerHTML=`
                <div class="row">
                <div class="col-lg-12 mb-4">
                
                    <div class="card"> 

                    <div class="card-header">
                        <h2 class="h6 mb-0 text-uppercase">Quizes</h2>
                    </div>

                    <div class="card-body">
                        <p class="text-gray mb-5">Take your Quizzes.</p>
                        `+str_ongoing+`
                        
                    </div>

                    </div>

                    

                </div>
                <div class="col-12">
                    <div class="card"> 

                    <div class="card-header">
                        <h2 class="h6 mb-0 text-uppercase">Attempted</h2>
                    </div>

                    <div class="card-body">
                        <p class="text-gray mb-5">Completed Quizzes and expired Quizes</p>
                        <div class="d-flex justify-content-between align-items-start align-items-sm-center mb-4 flex-column flex-sm-row" style="position: relative;">
                        <div class="left d-flex align-items-center">
                            <!-- <div class="icon icon-lg shadow mr-3 text-gray"><i class="fab fa-dropbox"></i></div> -->
                            <div class="text">
                            <h6 class="mb-0 d-flex align-items-center"> <span></span></h6><small class="text-gray"></small>
                            </div>
                        </div>
                        <div class="right ml-5 ml-sm-0 pl-3 pl-sm-0 text-violet" style="position: absolute; right: 0px;">
                            <table style="border:0px;">
                                        <tr><td>Score</td></tr>
                                        </table>
                        </div>
                        </div>
                        
                        `+expired+`
                        
                    </div>
                    </div>
                </div>
            </div>
            `
            
          
            
            }

            $.get("http://127.0.0.1:8000/quiz/view",cb);
            
            // console.log("hoho")

        }

        window.onload = function(){
        document.getElementById("profile_section").className="py-5 disappeared";
        var name = sessionStorage.getItem("handle");
        console.log("handler "+name)
        if(name=="post")
        {
          mypost();
        } 
        else if(name=="quiz")
        {
          myquiz();
        }
        else
        {
          myhome();
        }


        
        

      };

      window.onbeforeunload=function(){
        var str=document.getElementById("handle_id");

        sessionStorage.setItem("handle",str.value);

      }

      
     

      


    </script>



    <!-- JavaScript files-->
    <script src="{% static 'bubbly/vendor/jquery/jquery.min.js' %}"></script>
    <script src="{% static 'bubbly/vendor/popper.js/umd/popper.min.js' %}"> </script>
    <script src="{% static 'bubbly/vendor/bootstrap/js/bootstrap.min.js' %}"></script>
    <script src="{% static 'bubbly/vendor/jquery.cookie/jquery.cookie.js' %}"> </script>
    <script src="{% static 'bubbly/vendor/chart.js/Chart.min.js' %}"></script>
    <script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script>
    <script src="{% static 'bubbly/js/charts-home.js' %}"></script>
    <script src="{% static 'bubbly/js/front.js' %}"></script>
	
	
	
	

	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-172723038-1"></script>
	<script>
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());

	gtag('config', 'UA-172723038-1');
	</script>
	

	
</body>
</html>
